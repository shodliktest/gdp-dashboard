<!DOCTYPE html>
<html lang="uz" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TestPro â€” Admin Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <!-- Chart.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
  <style>
    .topbar{display:none;position:fixed;top:0;left:0;right:0;height:64px;background:var(--navbar-bg);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);align-items:center;justify-content:space-between;padding:0 1.25rem;z-index:200;}
    @media(max-width:1024px){.topbar{display:flex;}}
    .topbar-logo{font-family:'Syne',sans-serif;font-size:1.3rem;font-weight:800;background:var(--grad-1);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
    .sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);backdrop-filter:blur(4px);z-index:99;}
    .sidebar-overlay.show{display:block;}

    .admin-stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1.25rem;
      margin-bottom: 2rem;
    }

    .data-table-wrapper {
      overflow-x: auto;
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.88rem;
    }

    .data-table th {
      text-align: left;
      padding: 0.85rem 1.25rem;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-3);
      border-bottom: 1px solid var(--border);
      background: var(--surface-2);
      white-space: nowrap;
    }

    .data-table td {
      padding: 0.9rem 1.25rem;
      border-bottom: 1px solid var(--border);
      color: var(--text);
      vertical-align: middle;
    }

    .data-table tr:last-child td { border-bottom: none; }

    .data-table tr:hover td {
      background: var(--surface);
    }

    .chart-card {
      position: relative;
      height: 280px;
    }

    .tab-bar {
      display: flex;
      gap: 0.25rem;
      background: var(--surface-2);
      padding: 4px;
      border-radius: var(--radius-sm);
      margin-bottom: 1.5rem;
      border: 1px solid var(--border);
      width: fit-content;
    }

    .tab-pill {
      padding: 0.5rem 1.25rem;
      border-radius: 6px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition);
      border: none;
      background: none;
      color: var(--text-2);
      font-family: 'DM Sans', sans-serif;
    }

    .tab-pill.active {
      background: var(--bg);
      color: var(--accent);
      box-shadow: 0 2px 8px var(--shadow);
    }

    .tab-content { display: none; }
    .tab-content.active { display: block; }

    @media (max-width: 900px) {
      .admin-stats { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 480px) {
      .admin-stats { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <div class="topbar">
    <div class="topbar-logo">TestPro Admin</div>
    <div style="display:flex;gap:0.75rem;align-items:center">
      <button class="theme-toggle">ğŸŒ™</button>
      <button class="hamburger sidebar-toggle"><span></span><span></span><span></span></button>
    </div>
  </div>

  <div class="sidebar-overlay"></div>

  <aside class="sidebar">
    <div class="sidebar-logo">ğŸ‘‘ Admin</div>
    <nav class="sidebar-nav">
      <div class="sidebar-section-title">Admin</div>
      <a href="admin.html" class="sidebar-nav-item active"><span class="nav-icon">ğŸ“Š</span> Dashboard</a>

      <div class="sidebar-section-title" style="margin-top:0.75rem">Boshqaruv</div>
      <a href="#" class="sidebar-nav-item" onclick="switchTab('users')"><span class="nav-icon">ğŸ‘¥</span> Foydalanuvchilar</a>
      <a href="#" class="sidebar-nav-item" onclick="switchTab('tests')"><span class="nav-icon">ğŸ“</span> Testlar</a>
      <a href="#" class="sidebar-nav-item" onclick="switchTab('results')"><span class="nav-icon">ğŸ†</span> Natijalar</a>

      <div class="sidebar-section-title" style="margin-top:0.75rem">Navigatsiya</div>
      <a href="dashboard.html" class="sidebar-nav-item"><span class="nav-icon">ğŸ </span> Dashboard</a>
      <a href="create.html" class="sidebar-nav-item"><span class="nav-icon">âœï¸</span> Test yaratish</a>
    </nav>
    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar" id="user-avatar">A</div>
        <div>
          <div class="user-name" id="user-name">Admin</div>
          <div class="user-role">ğŸ‘‘ Admin</div>
        </div>
        <button id="logout-btn" class="btn btn-ghost btn-sm" style="margin-left:auto">ğŸšª</button>
      </div>
    </div>
  </aside>

  <main class="main-content">
    <div class="page-header">
      <h1>Admin Panel</h1>
      <p>Barcha foydalanuvchilar, testlar va natijalarni boshqaring.</p>
    </div>

    <!-- Stats -->
    <div class="admin-stats">
      <div class="stat-card fade-in">
        <div class="stat-icon stat-icon-1">ğŸ‘¥</div>
        <div class="stat-value" id="stat-users">â€”</div>
        <div class="stat-label">Jami foydalanuvchi</div>
      </div>
      <div class="stat-card fade-in delay-1">
        <div class="stat-icon stat-icon-2">ğŸ“</div>
        <div class="stat-value" id="stat-tests">â€”</div>
        <div class="stat-label">Jami testlar</div>
      </div>
      <div class="stat-card fade-in delay-2">
        <div class="stat-icon stat-icon-3">ğŸ†</div>
        <div class="stat-value" id="stat-results">â€”</div>
        <div class="stat-label">Jami natijalar</div>
      </div>
      <div class="stat-card fade-in delay-3">
        <div class="stat-icon stat-icon-4">ğŸ“ˆ</div>
        <div class="stat-value" id="stat-avg">â€”</div>
        <div class="stat-label">O'rtacha ball</div>
      </div>
    </div>

    <!-- Charts -->
    <div class="grid-2" style="margin-bottom:2rem">
      <div class="glass-card fade-in">
        <h3 style="font-size:0.95rem;margin-bottom:1.25rem">ğŸ“Š So'nggi 7 kun aktivligi</h3>
        <div class="chart-card">
          <canvas id="activity-chart"></canvas>
        </div>
      </div>
      <div class="glass-card fade-in delay-1">
        <h3 style="font-size:0.95rem;margin-bottom:1.25rem">ğŸ¯ Ball taqsimlanishi</h3>
        <div class="chart-card">
          <canvas id="score-chart"></canvas>
        </div>
      </div>
    </div>

    <!-- Tabs -->
    <div class="tab-bar">
      <button class="tab-pill active" onclick="switchTab('users')">ğŸ‘¥ Foydalanuvchilar</button>
      <button class="tab-pill" onclick="switchTab('tests')">ğŸ“ Testlar</button>
      <button class="tab-pill" onclick="switchTab('results')">ğŸ† Natijalar</button>
    </div>

    <!-- Users tab -->
    <div class="tab-content active" id="tab-users">
      <div class="glass-card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.25rem;flex-wrap:wrap;gap:1rem">
          <h2 style="font-size:1rem">Foydalanuvchilar ro'yxati</h2>
          <input type="text" class="form-input" style="max-width:240px"
            placeholder="ğŸ” Qidirish..." oninput="filterUsers(this.value)" />
        </div>
        <div class="data-table-wrapper">
          <table class="data-table" id="users-table">
            <thead>
              <tr>
                <th>Foydalanuvchi</th>
                <th>Email</th>
                <th>Rol</th>
                <th>Ro'yxat sanasi</th>
                <th>Amallar</th>
              </tr>
            </thead>
            <tbody id="users-tbody">
              <tr><td colspan="5" style="text-align:center;padding:2rem;color:var(--text-3)">Yuklanmoqda...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Tests tab -->
    <div class="tab-content" id="tab-tests">
      <div class="glass-card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.25rem;flex-wrap:wrap;gap:1rem">
          <h2 style="font-size:1rem">Barcha testlar</h2>
          <a href="create.html" class="btn btn-primary btn-sm">+ Yangi test</a>
        </div>
        <div class="data-table-wrapper">
          <table class="data-table">
            <thead>
              <tr>
                <th>Test nomi</th>
                <th>Muallif</th>
                <th>Ko'rinish</th>
                <th>Savollar</th>
                <th>Urinishlar</th>
                <th>Yaratilgan</th>
                <th>Amallar</th>
              </tr>
            </thead>
            <tbody id="tests-tbody">
              <tr><td colspan="7" style="text-align:center;padding:2rem;color:var(--text-3)">Yuklanmoqda...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Results tab -->
    <div class="tab-content" id="tab-results">
      <div class="glass-card">
        <h2 style="font-size:1rem;margin-bottom:1.25rem">So'nggi natijalar</h2>
        <div class="data-table-wrapper">
          <table class="data-table">
            <thead>
              <tr>
                <th>Test</th>
                <th>Foydalanuvchi</th>
                <th>Ball</th>
                <th>To'g'ri</th>
                <th>Vaqt</th>
                <th>Holat</th>
                <th>Sana</th>
              </tr>
            </thead>
            <tbody id="results-tbody">
              <tr><td colspan="7" style="text-align:center;padding:2rem;color:var(--text-3)">Yuklanmoqda...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </main>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="js/firebase.js"></script>
  <script src="js/theme.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/admin.js"></script>

</body>
</html>
