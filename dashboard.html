<!DOCTYPE html>
<html lang="uz" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TestPro â€” Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* â”€â”€ Sidebar overlay for mobile â”€â”€ */
    .sidebar-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(4px);
      z-index: 99;
    }
    .sidebar-overlay.show { display: block; }

    /* Top bar for mobile */
    .topbar {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0;
      height: 64px;
      background: var(--navbar-bg);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border);
      align-items: center;
      justify-content: space-between;
      padding: 0 1.25rem;
      z-index: 200;
    }

    @media (max-width: 1024px) {
      .topbar { display: flex; }
    }

    .topbar-logo {
      font-family: 'Syne', sans-serif;
      font-size: 1.3rem;
      font-weight: 800;
      background: var(--grad-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Dashboard specific */
    .stats-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.25rem;
      margin-bottom: 2rem;
    }

    .test-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .test-item {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.25rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      transition: all var(--transition);
      backdrop-filter: blur(12px);
    }

    .test-item:hover {
      border-color: var(--accent);
      transform: translateX(4px);
      box-shadow: 0 8px 24px var(--shadow);
    }

    .test-item-info h3 {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
    }

    .test-item-meta {
      display: flex;
      gap: 0.75rem;
      font-size: 0.78rem;
      color: var(--text-3);
      flex-wrap: wrap;
    }

    .test-item-meta span {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .test-actions {
      display: flex;
      gap: 0.5rem;
      flex-shrink: 0;
    }

    .results-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .result-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.85rem 1.25rem;
      background: var(--surface-2);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.87rem;
      transition: all var(--transition);
    }

    .result-item:hover {
      background: var(--surface);
      border-color: var(--accent);
    }

    .result-score {
      font-family: 'Syne', sans-serif;
      font-weight: 800;
      font-size: 1rem;
    }

    .score-high { color: #2ecc71; }
    .score-mid  { color: #f39c12; }
    .score-low  { color: #e74c3c; }

    .content-grid {
      display: grid;
      grid-template-columns: 1fr 360px;
      gap: 1.5rem;
    }

    @media (max-width: 1280px) {
      .content-grid { grid-template-columns: 1fr; }
    }

    @media (max-width: 768px) {
      .stats-row { grid-template-columns: 1fr 1fr; }
    }

    @media (max-width: 480px) {
      .stats-row { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <!-- Mobile topbar -->
  <div class="topbar">
    <div class="topbar-logo">TestPro</div>
    <div style="display:flex;gap:0.75rem;align-items:center">
      <button class="theme-toggle">ğŸŒ™</button>
      <button class="hamburger sidebar-toggle" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>

  <div class="sidebar-overlay"></div>

  <!-- â”€â”€ Sidebar â”€â”€ -->
  <aside class="sidebar">
    <div class="sidebar-logo">TestPro</div>

    <nav class="sidebar-nav">
      <div class="sidebar-section-title">Asosiy</div>

      <a href="dashboard.html" class="sidebar-nav-item active">
        <span class="nav-icon">ğŸ“Š</span> Dashboard
      </a>
      <a href="create.html" class="sidebar-nav-item">
        <span class="nav-icon">âœï¸</span> Test yaratish
      </a>

      <div class="sidebar-section-title" style="margin-top:0.75rem">Mening</div>

      <a href="#my-tests" class="sidebar-nav-item" onclick="showSection('my-tests')">
        <span class="nav-icon">ğŸ“</span> Testlarim
      </a>
      <a href="#my-results" class="sidebar-nav-item" onclick="showSection('my-results')">
        <span class="nav-icon">ğŸ†</span> Natijalarim
      </a>

      <div class="sidebar-section-title" style="margin-top:0.75rem">Hamjamiyat</div>

      <a href="#public-tests" class="sidebar-nav-item" onclick="showSection('public-tests')">
        <span class="nav-icon">ğŸŒ</span> Ommaviy testlar
      </a>

      <div style="flex:1"></div>

      <div class="sidebar-section-title" style="margin-top:0.75rem">Sozlamalar</div>
      <a href="#" class="sidebar-nav-item">
        <span class="nav-icon">âš™ï¸</span> Profil
      </a>
    </nav>

    <div class="sidebar-footer">
      <div class="user-info" id="user-info-card">
        <div class="user-avatar" id="user-avatar">?</div>
        <div>
          <div class="user-name" id="user-name">Yuklanmoqda...</div>
          <div class="user-role" id="user-role">foydalanuvchi</div>
        </div>
        <button id="logout-btn" class="btn btn-ghost btn-sm" style="margin-left:auto" data-tooltip="Chiqish">ğŸšª</button>
      </div>
    </div>
  </aside>

  <!-- â”€â”€ Main Content â”€â”€ -->
  <main class="main-content" id="main">

    <!-- Header -->
    <div class="page-header">
      <h1>Dashboard</h1>
      <p>Xush kelibsiz! Bu yerda barcha statistikangiz.</p>
    </div>

    <!-- Stats row -->
    <div class="stats-row">
      <div class="stat-card fade-in">
        <div class="stat-icon stat-icon-1">ğŸ“</div>
        <div class="stat-value" id="stat-tests">0</div>
        <div class="stat-label">Yaratilgan testlar</div>
      </div>

      <div class="stat-card fade-in delay-1">
        <div class="stat-icon stat-icon-2">âœ…</div>
        <div class="stat-value" id="stat-attempts">0</div>
        <div class="stat-label">O'tkazishlar</div>
      </div>

      <div class="stat-card fade-in delay-2">
        <div class="stat-icon stat-icon-3">â­</div>
        <div class="stat-value" id="stat-avg">â€”</div>
        <div class="stat-label">O'rtacha ball</div>
      </div>
    </div>

    <!-- Content grid -->
    <div class="content-grid">

      <!-- Left column -->
      <div>
        <!-- My Tests -->
        <div class="glass-card fade-in" style="margin-bottom:1.5rem" id="my-tests">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem">
            <h2 style="font-size:1.1rem">ğŸ“ Mening testlarim</h2>
            <a href="create.html" class="btn btn-primary btn-sm">+ Yangi test</a>
          </div>

          <div class="test-list" id="my-tests-list">
            <div class="empty-state">
              <div class="empty-state-icon">ğŸ“­</div>
              <h3>Hali test yo'q</h3>
              <p style="font-size:0.85rem">Birinchi testingizni yarating!</p>
              <a href="create.html" class="btn btn-primary btn-sm" style="margin-top:1rem">Test yaratish</a>
            </div>
          </div>
        </div>

        <!-- Public tests -->
        <div class="glass-card fade-in delay-1" id="public-tests">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem">
            <h2 style="font-size:1.1rem">ğŸŒ Ommaviy testlar</h2>
            <span class="badge badge-primary" id="public-count">0 ta</span>
          </div>

          <div class="test-list" id="public-tests-list">
            <div class="empty-state">
              <div class="empty-state-icon">ğŸ”</div>
              <h3>Testlar yuklanmoqda...</h3>
            </div>
          </div>
        </div>
      </div>

      <!-- Right column -->
      <div>
        <!-- Recent results -->
        <div class="glass-card fade-in delay-2" id="my-results">
          <h2 style="font-size:1.1rem;margin-bottom:1.25rem">ğŸ† So'nggi natijalar</h2>

          <div class="results-list" id="results-list">
            <div class="empty-state" style="padding:2rem 1rem">
              <div class="empty-state-icon">ğŸ“Š</div>
              <h3>Natijalar yo'q</h3>
              <p style="font-size:0.82rem">Biror testni o'tkazing!</p>
            </div>
          </div>
        </div>

        <!-- Quick actions -->
        <div class="glass-card fade-in delay-3" style="margin-top:1.25rem">
          <h2 style="font-size:1rem;margin-bottom:1rem;color:var(--text-2)">Tezkor harakatlar</h2>
          <div style="display:flex;flex-direction:column;gap:0.5rem">
            <a href="create.html" class="btn btn-primary" style="justify-content:center">
              âœï¸ Yangi test yaratish
            </a>
            <button class="btn btn-secondary" style="justify-content:center" onclick="copyJoinLink()">
              ğŸ”— Test havolasini ulashish
            </button>
          </div>
        </div>

        <!-- Theme card -->
        <div class="glass-card fade-in delay-4" style="margin-top:1.25rem;text-align:center">
          <p style="font-size:0.82rem;color:var(--text-3);margin-bottom:0.75rem">Interfeys rejimi</p>
          <button class="theme-toggle" style="width:auto;padding:0.5rem 1.5rem;border-radius:99px;gap:0.5rem;display:inline-flex;align-items:center">
            <span>ğŸŒ™</span> <span id="theme-label">Qorong'i rejim</span>
          </button>
        </div>

      </div>
    </div>

  </main>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="js/firebase.js"></script>
  <script src="js/theme.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/dashboard.js"></script>

</body>
</html>
